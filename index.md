<br /><br />

Example diffusion chain + simulation rollout here.

## Abstract

We introduce Scenario Dreamer, a fully data-driven generative simulator for autonomous vehicle planning that generates both the initial traffic scene—comprising a lane graph and agent bounding boxes—and closed-loop agent behaviours. Existing approaches typically rasterize the initial scene, leading to parameter-heavy networks and redundant computation due to large regions of empty pixels. Moreover, we find that existing methods that employ rule-based agent behaviours lack diversity and realism. Scenario Dreamer instead employs a novel vectorized latent diffusion model for initial scene generation that directly operates on the vectorized scene elements and an autoregressive Transformer for data-driven agent behaviour simulation. Scenario Dreamer additionally supports scene extrapolation via diffusion inpainting, enabling the generation of unbounded simulation environments. Extensive experiments show that Scenario Dreamer outperforms existing generative simulators in realism and efficiency: the vectorized scene-generation base model achieves superior fidelity with around 2× fewer parameters, 6× lower generation latency, and 10× fewer GPU training hours compared to the strongest baseline. We confirm its practical utility by showing that reinforcement learning planning agents are more challenged in Scenario Dreamer environments than traditional non-generative simulation environments, especially on long and adversarial driving environments.

## Vectorized Latent Diffusion for Scene Generation

![img](src/arch_figure_website.png)

We embed each vectorized scene element into a latent representation with an autoencoder parameterized with factorized attention blocks, which additionally fuses the lane connectivity A. The latent Transformer diffusion model is trained to sample from the autoencoder's latent distribution. Scenario Dreamer samples novel driving scenes by initializing noise tokens which are iteratively denoised with the latent diffusion model over T steps and decoded into vectorized scene elements. The ego vehicle is denoted in red, with other agents colored in blue and pedestrians in purple.

## Fully Data-Driven Generative Simulation

We initialize simulation environments with Scenario Dreamer scenes and simulate surrounding agents with a CtRL-Sim behaviour model, yielding a fully data-driven generative simulator for autonomous vehicle planning. Below, we show videos of an IDM-based planner driving in Scenario Dreamer generated environments.

<div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 2px;">
  <img src="src/data_driven_simulation_lowres/0.gif" width="250" alt="GIF 0" />
  <img src="src/data_driven_simulation_lowres/1.gif" width="250" alt="GIF 1" />
  <img src="src/data_driven_simulation_lowres/2.gif" width="250" alt="GIF 2" />
  <img src="src/data_driven_simulation_lowres/3.gif" width="250" alt="GIF 3" />
  <img src="src/data_driven_simulation_lowres/4.gif" width="250" alt="GIF 4" />
  <img src="src/data_driven_simulation_lowres/5.gif" width="250" alt="GIF 5" />
  <img src="src/data_driven_simulation_lowres/6.gif" width="250" alt="GIF 6" />
  <img src="src/data_driven_simulation_lowres/7.gif" width="250" alt="GIF 7" />
  <img src="src/data_driven_simulation_lowres/8.gif" width="250" alt="GIF 8" />
  <img src="src/data_driven_simulation_lowres/9.gif" width="250" alt="GIF 9" />
  <img src="src/data_driven_simulation_lowres/10.gif" width="250" alt="GIF 10" />
  <img src="src/data_driven_simulation_lowres/11.gif" width="250" alt="GIF 11" />
</div>

## Large Scene generation

A key feature of Scenario Dreamer is its ability to generate simulation environments of arbitrary size. Below, we visualize examples of 500m-route simulation environments generated by Scenario Dreamer via successive inpainting.

![img](src/website_large_scenes.png)

## Supported Generation Modes 

**Scene Generation**

<div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 2px;">
  <img src="src/0.gif" width="250" alt="GIF 0" />
  <img src="src/1.gif" width="250" alt="GIF 1" />
  <img src="src/2.gif" width="250" alt="GIF 2" />
  <img src="src/3.gif" width="250" alt="GIF 3" />
  <img src="src/4.gif" width="250" alt="GIF 4" />
  <img src="src/5.gif" width="250" alt="GIF 5" />
</div>

**Lane-conditioned Object Generation**

Examples here 

**Inpainting**

Examples here

## Scene Diversity 

Scenario Dreamer generates diverse scenes. The first row shows five inpainting extraploations given the same left-half of the scene. The second row shows five scenes generated with 8 agents and 24 lanes. In both cases, Scenario Dreamer demonstrates plausible diversity in the generated scenes.

![img](src/website_diversity.png)

## Qualitative Comparison with Baselines

Scenario Dreamer agent and lane generations exhibit superior fidelity compared to previous works (SLEDGE on nuPlan and privileged DriveSceneGen on Waymo). We attribute these improvements to the fully vectorized processing of Scenario Dreamer.

![img](src/website_qualitative_comparison.png)

## Citation

```bibtex
@InProceedings{rowe2025scenariodreamer,
  title={Scenario Dreamer: Vectorized Latent Diffusion for Generating Driving Simulation Environments},
  author={Rowe, Luke and Girgis, Roger and Gosselin, Anthony and Paull, Liam and Pal, Christopher and Heide, Felix},
  booktitle = {Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)},
  year={2025}
}
```
